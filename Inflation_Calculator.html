<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Inflation Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            line-height: 1.6;
            padding: 15px;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 20px 0 30px;
            margin-bottom: 20px;
        }
        
        .header h1 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: clamp(1rem, 2vw, 1.2rem);
            color: #7f8c8d;
            max-width: 700px;
            margin: 0 auto;
        }
        
        /* Main Layout */
        .calculator-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            padding: 25px;
        }
        
        .results-section {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            padding: 25px;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f0f0;
            font-weight: 600;
        }
        
        /* Input Groups */
        .input-group {
            margin-bottom: 22px;
        }
        
        .input-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .input-row label {
            font-weight: 600;
            color: #34495e;
            font-size: 1rem;
        }
        
        .value-display {
            font-weight: 700;
            color: #3498db;
            font-size: 1.1rem;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        input, select {
            width: 100%;
            padding: 16px 16px 16px 50px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: #fff;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        /* Better touch targets for mobile */
        input[type="number"], select {
            min-height: 56px;
        }
        
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        /* Date input styling */
        input[type="date"] {
            padding-left: 50px;
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #3498db;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }
        
        .toggle-label {
            font-weight: 600;
            color: #34495e;
        }
        
        /* Button Styles */
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
        }
        
        .button-group button {
            flex: 1;
            min-width: 140px;
            padding: 18px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .button-group button i {
            font-size: 1.1rem;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }
        
        .calculate-btn:hover, .calculate-btn:active {
            background: linear-gradient(135deg, #2980b9 0%, #2573a7 100%);
            transform: translateY(-2px);
        }
        
        .reset-btn {
            background-color: #f5f5f5;
            color: #333;
        }
        
        .reset-btn:hover, .reset-btn:active {
            background-color: #e0e0e0;
        }
        
        .compare-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .compare-btn:hover, .compare-btn:active {
            background-color: #27ae60;
        }
        
        /* Results Styles */
        .result-card {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
        }
        
        .result-card.highlight {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 4px solid #3498db;
        }
        
        .result-card.warning {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border-left: 4px solid #e74c3c;
        }
        
        .result-card.success {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 4px solid #2ecc71;
        }
        
        .result-title {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .result-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .result-subtitle {
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        
        .result-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .detail-item {
            text-align: center;
            padding: 12px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .detail-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        /* Chart Container */
        .chart-container {
            height: 300px;
            margin: 25px 0;
            position: relative;
        }
        
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        
        /* Timeline Section */
        .timeline-section {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            padding: 25px;
            margin-top: 25px;
        }
        
        .timeline-container {
            margin-top: 20px;
            overflow-x: auto;
        }
        
        .timeline {
            display: flex;
            min-width: 600px;
        }
        
        .timeline-year {
            flex: 1;
            text-align: center;
            padding: 10px 5px;
            position: relative;
        }
        
        .timeline-year.active {
            background-color: #e3f2fd;
            border-radius: 8px;
        }
        
        .year-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .year-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #3498db;
        }
        
        .year-inflation {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        /* Comparison Section */
        .comparison-section {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            padding: 25px;
            margin-top: 25px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .comparison-item {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .comparison-icon {
            font-size: 2rem;
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .comparison-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .comparison-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .calculator-wrapper {
                gap: 20px;
            }
            
            .input-section, .results-section {
                padding: 20px;
                min-width: 100%;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .result-details {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .result-value {
                font-size: 1.8rem;
            }
            
            .button-group button {
                min-width: 100%;
                padding: 16px;
            }
            
            .chart-container {
                height: 250px;
            }
            
            input, select {
                padding: 14px 14px 14px 45px;
                min-height: 52px;
            }
            
            /* Make everything more touch-friendly */
            button, input[type="range"], select {
                min-height: 44px;
            }
            
            .timeline {
                min-width: 100%;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Small Mobile Screens */
        @media (max-width: 480px) {
            .header {
                padding: 15px 0 20px;
            }
            
            .input-section, .results-section, .timeline-section, .comparison-section {
                padding: 18px;
                border-radius: 14px;
            }
            
            .result-value {
                font-size: 1.6rem;
            }
            
            .chart-container {
                height: 220px;
            }
            
            .detail-value {
                font-size: 1.1rem;
            }
        }
        
        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                color: #f0f0f0;
            }
            
            .input-section, .results-section, .timeline-section, .comparison-section {
                background-color: #2c3e50;
                color: #f0f0f0;
            }
            
            .input-row label, .section-title, .toggle-label {
                color: #ecf0f1;
            }
            
            input, select {
                background-color: #34495e;
                border-color: #4a6572;
                color: #ecf0f1;
            }
            
            input:focus, select:focus {
                border-color: #3498db;
            }
            
            .result-card {
                background-color: #34495e;
            }
            
            .result-card.highlight {
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            }
            
            .result-card.warning {
                background: linear-gradient(135deg, #5d1a1a 0%, #7a2a2a 100%);
            }
            
            .result-card.success {
                background: linear-gradient(135deg, #1e5d1a 0%, #2a7a2a 100%);
            }
            
            .result-title, .result-subtitle {
                color: #bdc3c7;
            }
            
            .result-value {
                color: #ecf0f1;
            }
            
            .detail-item {
                background-color: #3b4a5e;
                color: #ecf0f1;
            }
            
            .detail-label {
                color: #bdc3c7;
            }
            
            .comparison-item {
                background-color: #34495e;
            }
        }
        
        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .input-section, .results-section, .timeline-section, .comparison-section {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            button {
                display: none;
            }
        }
        
        /* Animation for results */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus styles for keyboard navigation */
        button:focus-visible, input:focus-visible, select:focus-visible {
            outline: 3px solid #3498db;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Inflation Calculator</h1>
            <p>Calculate how inflation affects the value of money over time. Compare purchasing power between different years.</p>
        </header>
        
        <main>
            <div class="calculator-wrapper">
                <section class="input-section" aria-labelledby="input-title">
                    <h2 id="input-title" class="section-title">Inflation Calculation</h2>
                    
                    <div class="input-group">
                        <div class="input-row">
                            <label for="amount">Amount</label>
                            <span class="value-display" id="amountValue">$1,000</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-dollar-sign input-icon"></i>
                            <input type="range" id="amount" class="slider" min="1" max="1000000" value="1000" step="100">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="toggle-container">
                            <label class="toggle-label">Calculate Forward</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="directionToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <label class="toggle-label">Calculate Backward</label>
                        </div>
                        <div class="toggle-description" id="directionDescription">
                            Calculate future value of money based on past inflation
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="input-row">
                            <label for="startYear">Start Year</label>
                            <span class="value-display" id="startYearValue">2000</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar input-icon"></i>
                            <input type="range" id="startYear" class="slider" min="1900" max="2024" value="2000" step="1">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="input-row">
                            <label for="endYear">End Year</label>
                            <span class="value-display" id="endYearValue">2024</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar input-icon"></i>
                            <input type="range" id="endYear" class="slider" min="1901" max="2024" value="2024" step="1">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="input-row">
                            <label for="inflationRate">Custom Inflation Rate (%)</label>
                            <span class="value-display" id="inflationRateValue">3.0</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-percent input-icon"></i>
                            <input type="range" id="inflationRate" class="slider" min="0.1" max="20" value="3.0" step="0.1">
                        </div>
                        <div class="toggle-container" style="margin-top: 15px;">
                            <label class="toggle-switch">
                                <input type="checkbox" id="useHistoricalToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <label class="toggle-label">Use Historical US Inflation Data</label>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="calculate-btn" id="calculateBtn" aria-label="Calculate inflation">
                            <i class="fas fa-calculator"></i> Calculate
                        </button>
                        <button class="compare-btn" id="compareBtn" aria-label="Compare with common items">
                            <i class="fas fa-balance-scale"></i> Compare
                        </button>
                        <button class="reset-btn" id="resetBtn" aria-label="Reset all values to default">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </section>
                
                <section class="results-section" aria-labelledby="results-title">
                    <h2 id="results-title" class="section-title">Inflation Results</h2>
                    
                    <div class="result-card highlight fade-in">
                        <div class="result-title" id="resultTitle">Value in 2024</div>
                        <div class="result-value" id="resultValue">$1,847.29</div>
                        <div class="result-subtitle" id="resultSubtitle">
                            <span id="originalAmountText">$1,000 in 2000</span> has the same purchasing power as 
                            <span id="adjustedAmountText">$1,847.29 in 2024</span>
                        </div>
                        
                        <div class="result-details">
                            <div class="detail-item">
                                <div class="detail-label">Total Inflation</div>
                                <div class="detail-value" id="totalInflation">84.73%</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Annual Inflation</div>
                                <div class="detail-value" id="annualInflation">2.99%</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Years</div>
                                <div class="detail-value" id="yearsDifference">24</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Loss of Value</div>
                                <div class="detail-value" id="valueLoss">-45.9%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="inflationChart" aria-label="Inflation impact chart" role="img"></canvas>
                    </div>
                    
                    <div class="result-card" id="explanationCard">
                        <div class="result-title">What This Means</div>
                        <p id="explanationText">
                            Due to inflation, $1,000 in 2000 is equivalent to $1,847.29 today. 
                            This means you would need $1,847.29 in 2024 to buy the same goods and services 
                            that $1,000 could purchase in 2000. Your money lost about 45.9% of its purchasing power over this period.
                        </p>
                    </div>
                </section>
            </div>
            
            <section class="timeline-section" aria-labelledby="timeline-title">
                <h2 id="timeline-title" class="section-title">Inflation Timeline</h2>
                <div class="timeline-container">
                    <div class="timeline" id="inflationTimeline">
                        <!-- Timeline will be generated here -->
                    </div>
                </div>
            </section>
            
            <section class="comparison-section" aria-labelledby="comparison-title">
                <h2 id="comparison-title" class="section-title">Purchasing Power Comparison</h2>
                <div class="comparison-grid" id="comparisonGrid">
                    <!-- Comparison items will be generated here -->
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Historical US Inflation Data (simplified)
        const historicalInflation = {
            "2024": 3.4, "2023": 4.1, "2022": 8.0, "2021": 4.7, "2020": 1.2,
            "2019": 1.8, "2018": 2.4, "2017": 2.1, "2016": 1.3, "2015": 0.1,
            "2014": 1.6, "2013": 1.5, "2012": 2.1, "2011": 3.2, "2010": 1.6,
            "2009": -0.4, "2008": 3.8, "2007": 2.9, "2006": 3.2, "2005": 3.4,
            "2004": 2.7, "2003": 2.3, "2002": 1.6, "2001": 2.8, "2000": 3.4,
            "1999": 2.2, "1998": 1.6, "1997": 2.3, "1996": 3.0, "1995": 2.8,
            "1994": 2.6, "1993": 3.0, "1992": 3.0, "1991": 4.2, "1990": 5.4,
            "1989": 4.8, "1988": 4.1, "1987": 3.6, "1986": 1.9, "1985": 3.6,
            "1984": 4.3, "1983": 3.2, "1982": 6.2, "1981": 10.3, "1980": 13.5,
            "1979": 11.3, "1978": 7.6, "1977": 6.5, "1976": 5.7, "1975": 9.1,
            "1974": 11.0, "1973": 6.2, "1972": 3.3, "1971": 4.3, "1970": 5.7,
            "1969": 5.5, "1968": 4.2, "1967": 2.8, "1966": 3.0, "1965": 1.6,
            "1964": 1.3, "1963": 1.3, "1962": 1.2, "1961": 1.1, "1960": 1.5,
            "1950": 1.3, "1940": 0.7, "1930": -2.7, "1920": 15.6, "1910": 4.2,
            "1900": 1.3
        };
        
        // Common items for comparison
        const commonItems = [
            { name: "Gallon of Milk", price1990: 2.78, price2024: 3.97, icon: "fa-wine-bottle" },
            { name: "Loaf of Bread", price1990: 0.70, price2024: 2.50, icon: "fa-bread-slice" },
            { name: "Gallon of Gas", price1990: 1.16, price2024: 3.58, icon: "fa-gas-pump" },
            { name: "Movie Ticket", price1990: 4.23, price2024: 10.53, icon: "fa-ticket-alt" },
            { name: "New Car", price1990: 16000, price2024: 48000, icon: "fa-car" },
            { name: "Average House", price1990: 123000, price2024: 430000, icon: "fa-home" }
        ];

        // DOM Elements
        const amountSlider = document.getElementById('amount');
        const amountValue = document.getElementById('amountValue');
        const directionToggle = document.getElementById('directionToggle');
        const directionDescription = document.getElementById('directionDescription');
        const startYearSlider = document.getElementById('startYear');
        const startYearValue = document.getElementById('startYearValue');
        const endYearSlider = document.getElementById('endYear');
        const endYearValue = document.getElementById('endYearValue');
        const inflationRateSlider = document.getElementById('inflationRate');
        const inflationRateValue = document.getElementById('inflationRateValue');
        const useHistoricalToggle = document.getElementById('useHistoricalToggle');
        
        // Result Elements
        const resultTitle = document.getElementById('resultTitle');
        const resultValue = document.getElementById('resultValue');
        const resultSubtitle = document.getElementById('resultSubtitle');
        const originalAmountText = document.getElementById('originalAmountText');
        const adjustedAmountText = document.getElementById('adjustedAmountText');
        const totalInflation = document.getElementById('totalInflation');
        const annualInflation = document.getElementById('annualInflation');
        const yearsDifference = document.getElementById('yearsDifference');
        const valueLoss = document.getElementById('valueLoss');
        const explanationText = document.getElementById('explanationText');
        
        // Timeline and Comparison Elements
        const inflationTimeline = document.getElementById('inflationTimeline');
        const comparisonGrid = document.getElementById('comparisonGrid');
        
        // Buttons
        const calculateBtn = document.getElementById('calculateBtn');
        const compareBtn = document.getElementById('compareBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        // Chart
        let inflationChart;
        
        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Format percentage
        function formatPercentage(amount) {
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Update slider value display
        function updateSliderValue(slider, displayElement, isCurrency = false, isYear = false) {
            let value = parseFloat(slider.value);
            if (isCurrency) {
                displayElement.textContent = `$${formatCurrency(value)}`;
            } else if (isYear) {
                displayElement.textContent = Math.round(value);
            } else {
                displayElement.textContent = formatPercentage(value);
            }
        }
        
        // Get historical inflation rate for a year
        function getHistoricalInflation(year) {
            const yearStr = year.toString();
            if (historicalInflation[yearStr] !== undefined) {
                return historicalInflation[yearStr] / 100;
            }
            
            // Estimate for years not in data
            if (year < 1900) return 0.02; // 2% before 1900
            if (year > 2024) return 0.03; // 3% after 2024
            
            // Find closest year
            const years = Object.keys(historicalInflation).map(y => parseInt(y));
            const closestYear = years.reduce((prev, curr) => {
                return (Math.abs(curr - year) < Math.abs(prev - year) ? curr : prev);
            });
            return historicalInflation[closestYear.toString()] / 100;
        }
        
        // Calculate inflation-adjusted value
        function calculateInflation() {
            // Get input values
            const amount = parseFloat(amountSlider.value);
            const startYear = parseInt(startYearSlider.value);
            const endYear = parseInt(endYearSlider.value);
            const customRate = parseFloat(inflationRateSlider.value) / 100;
            const useHistorical = useHistoricalToggle.checked;
            const isForward = directionToggle.checked;
            
            // Ensure start year is before end year
            let fromYear, toYear;
            if (isForward) {
                fromYear = Math.min(startYear, endYear);
                toYear = Math.max(startYear, endYear);
            } else {
                fromYear = Math.max(startYear, endYear);
                toYear = Math.min(startYear, endYear);
            }
            
            const years = toYear - fromYear;
            
            // Calculate inflation-adjusted value
            let adjustedAmount = amount;
            let totalInflationRate = 1;
            let annualRates = [];
            
            if (useHistorical) {
                // Use historical inflation data
                for (let year = fromYear; year < toYear; year++) {
                    const inflationRate = getHistoricalInflation(year);
                    totalInflationRate *= (1 + inflationRate);
                    annualRates.push(inflationRate * 100);
                }
                adjustedAmount = amount * totalInflationRate;
            } else {
                // Use custom inflation rate
                totalInflationRate = Math.pow(1 + customRate, years);
                adjustedAmount = amount * totalInflationRate;
                annualRates = Array(years).fill(customRate * 100);
            }
            
            // Calculate derived values
            const totalInflationPercent = (totalInflationRate - 1) * 100;
            const averageAnnualInflation = (Math.pow(totalInflationRate, 1/years) - 1) * 100;
            const purchasingPowerLoss = (1 - (amount / adjustedAmount)) * 100;
            
            // Update results
            if (isForward) {
                resultTitle.textContent = `Value in ${toYear}`;
                resultValue.textContent = `$${formatCurrency(adjustedAmount)}`;
                originalAmountText.textContent = `$${formatCurrency(amount)} in ${fromYear}`;
                adjustedAmountText.textContent = `$${formatCurrency(adjustedAmount)} in ${toYear}`;
            } else {
                resultTitle.textContent = `Value in ${toYear}`;
                resultValue.textContent = `$${formatCurrency(adjustedAmount)}`;
                originalAmountText.textContent = `$${formatCurrency(amount)} in ${fromYear}`;
                adjustedAmountText.textContent = `$${formatCurrency(adjustedAmount)} in ${toYear}`;
            }
            
            resultSubtitle.innerHTML = `<span id="originalAmountText">$${formatCurrency(amount)} in ${fromYear}</span> has the same purchasing power as <span id="adjustedAmountText">$${formatCurrency(adjustedAmount)} in ${toYear}</span>`;
            
            totalInflation.textContent = `${formatPercentage(totalInflationPercent)}%`;
            annualInflation.textContent = `${formatPercentage(averageAnnualInflation)}%`;
            yearsDifference.textContent = years;
            valueLoss.textContent = `${formatPercentage(purchasingPowerLoss)}%`;
            
            // Update explanation text
            explanationText.innerHTML = `
                Due to inflation, $${formatCurrency(amount)} in ${fromYear} is equivalent to $${formatCurrency(adjustedAmount)} today. 
                This means you would need $${formatCurrency(adjustedAmount)} in ${toYear} to buy the same goods and services 
                that $${formatCurrency(amount)} could purchase in ${fromYear}. Your money lost about ${formatPercentage(purchasingPowerLoss)}% 
                of its purchasing power over this period.
            `;
            
            // Update chart
            updateChart(fromYear, toYear, amount, adjustedAmount, useHistorical, customRate);
            
            // Update timeline
            updateTimeline(fromYear, toYear, amount, useHistorical, customRate);
            
            // Add animation class
            document.querySelectorAll('.fade-in').forEach(element => {
                element.classList.remove('fade-in');
                void element.offsetWidth; // Trigger reflow
                element.classList.add('fade-in');
            });
        }
        
        // Update comparison grid
        function updateComparison() {
            const startYear = parseInt(startYearSlider.value);
            const endYear = parseInt(endYearSlider.value);
            const useHistorical = useHistoricalToggle.checked;
            const customRate = parseFloat(inflationRateSlider.value) / 100;
            
            comparisonGrid.innerHTML = '';
            
            commonItems.forEach(item => {
                // Calculate inflation between startYear and endYear
                let inflationFactor = 1;
                const years = Math.abs(endYear - startYear);
                
                if (useHistorical) {
                    for (let year = Math.min(startYear, endYear); year < Math.max(startYear, endYear); year++) {
                        inflationFactor *= (1 + getHistoricalInflation(year));
                    }
                } else {
                    inflationFactor = Math.pow(1 + customRate, years);
                }
                
                // Calculate adjusted price
                let adjustedPrice;
                if (endYear > startYear) {
                    adjustedPrice = item.price1990 * inflationFactor;
                } else {
                    adjustedPrice = item.price2024 / inflationFactor;
                }
                
                const comparisonCard = document.createElement('div');
                comparisonCard.className = 'comparison-item fade-in';
                comparisonCard.innerHTML = `
                    <div class="comparison-icon">
                        <i class="fas ${item.icon}"></i>
                    </div>
                    <div class="comparison-title">${item.name}</div>
                    <div class="comparison-value">$${formatCurrency(adjustedPrice)}</div>
                    <div class="comparison-subtitle">
                        ${startYear > endYear ? `Would have cost $${formatCurrency(item.price1990)} in ${endYear}` : `Would cost $${formatCurrency(item.price2024)} today`}
                    </div>
                `;
                
                comparisonGrid.appendChild(comparisonCard);
            });
        }
        
        // Create or update chart
        function updateChart(startYear, endYear, originalAmount, adjustedAmount, useHistorical, customRate) {
            const ctx = document.getElementById('inflationChart').getContext('2d');
            const years = Math.abs(endYear - startYear);
            const labels = [];
            const valueData = [];
            const inflationData = [];
            
            // Generate data for each year
            let currentValue = originalAmount;
            for (let i = 0; i <= years; i++) {
                const currentYear = startYear + i;
                labels.push(currentYear);
                valueData.push(currentValue);
                
                // Get inflation rate for this year
                let inflationRate;
                if (useHistorical && i < years) {
                    inflationRate = getHistoricalInflation(currentYear);
                    inflationData.push(inflationRate * 100);
                } else if (i < years) {
                    inflationRate = customRate;
                    inflationData.push(inflationRate * 100);
                }
                
                // Calculate next year's value
                if (i < years) {
                    currentValue *= (1 + inflationRate);
                }
            }
            
            // Destroy existing chart if it exists
            if (inflationChart) {
                inflationChart.destroy();
            }
            
            // Create new chart
            inflationChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Purchasing Power',
                            data: valueData,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Inflation Rate (%)',
                            data: inflationData,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.3,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    stacked: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: window.innerWidth < 768 ? 12 : 14
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label.includes('Purchasing Power')) {
                                        label += ': $' + formatCurrency(context.parsed.y);
                                    } else {
                                        label += ': ' + formatPercentage(context.parsed.y) + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year',
                                font: {
                                    size: window.innerWidth < 768 ? 12 : 14
                                }
                            },
                            ticks: {
                                maxTicksLimit: window.innerWidth < 768 ? 6 : 10,
                                font: {
                                    size: window.innerWidth < 768 ? 10 : 12
                                }
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Value ($)',
                                font: {
                                    size: window.innerWidth < 768 ? 12 : 14
                                }
                            },
                            ticks: {
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    } else if (value >= 1000) {
                                        return '$' + (value / 1000).toFixed(0) + 'K';
                                    }
                                    return '$' + value;
                                },
                                font: {
                                    size: window.innerWidth < 768 ? 10 : 12
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Inflation Rate (%)',
                                font: {
                                    size: window.innerWidth < 768 ? 12 : 14
                                }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                font: {
                                    size: window.innerWidth < 768 ? 10 : 12
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update timeline
        function updateTimeline(startYear, endYear, amount, useHistorical, customRate) {
            inflationTimeline.innerHTML = '';
            const years = Math.abs(endYear - startYear);
            const step = Math.max(1, Math.floor(years / 8));
            
            let currentValue = amount;
            for (let i = 0; i <= years; i += step) {
                const currentYear = startYear + i;
                
                // Calculate value for this year
                if (i > 0) {
                    for (let j = 0; j < step; j++) {
                        const year = startYear + i - step + j;
                        if (year < currentYear) {
                            const inflationRate = useHistorical ? getHistoricalInflation(year) : customRate;
                            currentValue *= (1 + inflationRate);
                        }
                    }
                }
                
                const timelineYear = document.createElement('div');
                timelineYear.className = `timeline-year ${currentYear === endYear ? 'active' : ''}`;
                timelineYear.innerHTML = `
                    <div class="year-label">${currentYear}</div>
                    <div class="year-value">$${formatCurrency(currentValue)}</div>
                    <div class="year-inflation">
                        ${useHistorical ? formatPercentage(getHistoricalInflation(currentYear) * 100) + '%' : formatPercentage(customRate * 100) + '%'}
                    </div>
                `;
                
                inflationTimeline.appendChild(timelineYear);
            }
        }
        
        // Initialize event listeners
        function initializeEventListeners() {
            // Update slider value displays when sliders change
            const sliders = [
                { slider: amountSlider, display: amountValue, currency: true, year: false },
                { slider: startYearSlider, display: startYearValue, currency: false, year: true },
                { slider: endYearSlider, display: endYearValue, currency: false, year: true },
                { slider: inflationRateSlider, display: inflationRateValue, currency: false, year: false }
            ];
            
            sliders.forEach(({ slider, display, currency, year }) => {
                slider.addEventListener('input', () => {
                    updateSliderValue(slider, display, currency, year);
                    calculateInflation();
                });
                
                // For touch devices, also update on change for better performance
                slider.addEventListener('change', () => {
                    updateSliderValue(slider, display, currency, year);
                    calculateInflation();
                });
            });
            
            // Direction toggle
            directionToggle.addEventListener('change', () => {
                directionDescription.textContent = directionToggle.checked 
                    ? "Calculate future value of money based on past inflation"
                    : "Calculate past value of money based on future inflation";
                calculateInflation();
            });
            
            // Historical data toggle
            useHistoricalToggle.addEventListener('change', () => {
                inflationRateSlider.disabled = useHistoricalToggle.checked;
                calculateInflation();
            });
            
            // Calculate button
            calculateBtn.addEventListener('click', calculateInflation);
            
            // Compare button
            compareBtn.addEventListener('click', updateComparison);
            
            // Reset button
            resetBtn.addEventListener('click', () => {
                amountSlider.value = 1000;
                startYearSlider.value = 2000;
                endYearSlider.value = 2024;
                inflationRateSlider.value = 3.0;
                directionToggle.checked = true;
                useHistoricalToggle.checked = true;
                
                // Update all displays
                sliders.forEach(({ slider, display, currency, year }) => {
                    updateSliderValue(slider, display, currency, year);
                });
                
                directionDescription.textContent = "Calculate future value of money based on past inflation";
                inflationRateSlider.disabled = true;
                
                // Recalculate
                calculateInflation();
                updateComparison();
            });
            
            // Handle window resize for chart responsiveness
            window.addEventListener('resize', () => {
                if (inflationChart) {
                    inflationChart.resize();
                }
            });
        }
        
        // Initialize the app
        function init() {
            // Set initial slider values
            updateSliderValue(amountSlider, amountValue, true, false);
            updateSliderValue(startYearSlider, startYearValue, false, true);
            updateSliderValue(endYearSlider, endYearValue, false, true);
            updateSliderValue(inflationRateSlider, inflationRateValue, false, false);
            
            // Disable inflation rate slider if using historical data
            inflationRateSlider.disabled = useHistoricalToggle.checked;
            
            // Calculate initial inflation
            calculateInflation();
            updateComparison();
            
            // Initialize event listeners
            initializeEventListeners();
        }
        
        // Start the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>